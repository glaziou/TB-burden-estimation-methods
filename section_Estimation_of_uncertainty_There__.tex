\section{Estimation of uncertainty}

There are many potential sources of uncertainty associated with estimates of TB incidence, prevalence and mortality, as well as estimates of the burden of HIV-associated TB and MDR-TB. These include uncertainties in input data, in parameter values, in extrapolations used to impute missing data, and in the models used. 

We used fixed population values from the UNPD. We did not account for any uncertainty in these values.  
Notification data are of uneven quality. Cases may be underreported (for example, missing quarterly reports from remote administrative areas are not uncommon), misclassified (in particular, misclassification of recurrent cases in the category of new cases is common), or overreported as a result of duplicated entries in TB information systems. The latter two issues can only be addressed efficiently in countries with case-based nationwide TB databases that include patient identifiers. Sudden changes in notifications over time are often the result of errors or inconsistencies in reporting, but may sometimes reflect abrupt changes in TB epidemiology (for example, resulting from a rapid influx of migrants from countries with a high burden of TB, or from rapid improvement in case-finding efforts). 

Missing national aggregates of new and recurrent cases were imputed by interpolation. Notification trajectories were smoothed using a penalized cubic splines function with parameters based on the data. Attempts to obtain corrections for historical data are made every year, but only rarely do countries provide appropriate data corrections. 

Mortality estimates incorporated the following sources of uncertainty: sampling uncertainty in the underlying measurements of TB mortality rates from data sources, uncertainty in estimates of incidence rates and rates of HIV prevalence among both incident and notified TB cases, and parameter uncertainty in models. Time series of TB mortality were generated for each country through Monte Carlo simulations. 
Unless otherwise specified, uncertainty bounds and ranges were defined as the 2.5th and 97.5th centiles of outcome distributions. Throughout this report, ranges with upper and lower bounds defined by these centiles are provided for all estimates established with the use of simulations. When uncertainty was established with the use of observed or other empirical data, 95\% confidence intervals are reported.
 
The model used followed the following steps: 

\begin{enumerate}
\item Overall TB incidence estimation after review and cleaning of case notification data;
\item cleaning and adjustment of raw mortality data from VR systems and mortality surveys, followed by imputation of missing values in countries with VR or survey data – in some countries, step 1 was updated to account for mortality data;
\item cleaning of measurements of HIV prevalence among TB patients followed by estimating HIV-positive TB incidence using the Spectrum programme and HIV-positive TB mortality;
\item cleaning of measurements of HIV prevalence among TB patients followed by estimating HIV-positive TB incidence using the Spectrum programme and HIV-positive TB mortality;
\item estimation of HIV prevalence among incident cases of TB through modelling in countries with no measurements;
\item estimation of HIV-negative TB mortality in countries with no VR data followed with an update of step 1 in some countries; 
\item review of prevalence measurements, adjustments for childhood TB and bacteriologically unconfirmed TB,  and estimation of prevalence followed with an update of step 1 in some countries; 
\item estimation of incidence and mortality disaggregated by age and sex and disaggregated by drug resistance status.
\end{enumerate}

The general approach to uncertainty analyses was to draw values from specified distributions for every parameter (except for notifications and population values) in Monte Carlo simulations, with the number of simulation runs set so that they were sufficient to ensure stability in the outcome distributions. For each country, the same random generator seed was used for every year, and errors were assumed to be time-dependent within countries (thus generating autocorrelation in time series). Regional parameters were used in some instances (for example, for CFRs). Summaries of quantities of interest were obtained by extracting the mean, 2.5th and 97.5th centiles of posterior distributions. Wherever possible, uncertainty was propagated analytically by approximating the moments of functions of random variables using second-order Taylor series expansion – such as when taking the product or the ratio of two random variables – rather than through Monte Carlo simulations, in order to shorten computing time. 

